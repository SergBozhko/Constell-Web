<!--Users page-->
<div class="page page-table">

    <div class="row ui-section">
        <div class="col-lg-12 clearfix">
            <h2 class="section-header">
                {{position.info.title}}
                <a href="#/positions/edit/{{position.info.id}}" class="btn btn-primary">Редактировать</a>
                <a ui-sref="positions" class="btn btn-primary">К списку позиций</a>
            </h2>
        </div>
        <div class="col-md-12">
            <section class="panel panel-default table-dynamic">

                <div class="constell-block-title mt-mini">Последние предложения</div>

                <div class="tender-best-offers-wrapper">
                    <!--Best offers table-->
                    <div class="best-offers-table-wrapper">
                        <div class="table-wrapper">
                            <table class="table table-bordered table-striped table-responsive">
                                <thead>
                                <tr>
                                    <th>
                                        <div class="th disabled-th">
                                            Позиция
                                        </div>
                                    </th>
                                    <th>
                                        <div class="th disabled-th">
                                            Объем
                                        </div>
                                    </th>
                                    <th ng-repeat="offerTitle in tender.offers.headerList">
                                        <div class="th">
                                            {{offerTitle}}
                                        </div>
                                    </th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr data-ng-repeat="offer in tender.offers.positions">
                                    <td>{{offer.positionTitle}}</td>
                                    <td>{{offer.positionAmount}}</td>
                                    <td ng-repeat="offerValue in offer.positionPriceList">
                                        <span ng-if="offerValue != null">{{offerValue}}</span>
                                        <span ng-if="offerValue == null">-</span>
                                    </td>
                                </tr>
                                <tr ng-if="tender.offersPreloader">
                                    <td colspan="2">
                                        <div class="constell-loader cl-block"></div>
                                    </td>
                                </tr>
                                <tr ng-if="tender.offers.positions.length == 0">
                                    <td colspan="2">
                                        Последние предложения отсутствуют
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!--Main inforamtion-->
                    <div class="col-md-12 constell-panel-info">
                        <div class="panel panel-default panel-labeled constell-panel-list">
                            <div class="panel-body">
                                <span class="panel-label">Информация</span>
                                <ul class="list-group no-margin">
                                    <li class="list-group-item">{{position.info.title}}</li>
                                    <li class="list-group-item"><b>ID: </b> {{position.info.id}}</li>
                                    <li class="list-group-item"><b>Категория: </b>{{position.info.category.name}}</li>
                                    <li class="list-group-item">
                                        <b>Единица измерения: </b> {{position.info.unit.name}}
                                    </li>
                                    <li class="list-group-item">
                                        <b>Валюта: </b> {{position.info.currency.name}}
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="constell-graph-area">
                    <div class="constell-block-title mt-mini">Все предложения</div>

                    <div data-echarts data-options="tender.combo.options" style="height: 360px;"></div>
                </div>

                <div class="table-filters">
                    <div class="row">
                        <div class="col-sm-4 col-xs-6">
                            <form>
                                <input type="text"
                                       placeholder="Найти..."
                                       class="form-control"
                                       data-ng-model="searchKeywords"
                                       data-ng-keyup="search()">
                            </form>
                        </div>
                        <div class="col-sm-3 col-xs-6 filter-result-info">
                <span>
                Showing {{filteredStores.length}}/{{stores.length}} entries
                </span>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table class="table table-bordered table-responsive">
                        <thead>
                        <tr>
                            <th>
                                <div class="th">
                                    <i class="zmdi zmdi-more-vert"></i>
                                </div>
                            </th>
                            <th>
                                <div class="th">
                                    ID
                                </div>
                            </th>
                            <th>
                                <div class="th">
                                    Имя
                                </div>
                            </th>
                            <th>
                                <div class="th">
                                    Цена (руб)
                                </div>
                            </th>
                            <th>
                                <div class="th">
                                    Дата
                                </div>
                            </th>
                            <th>
                                <div class="th">
                                    Комментарии
                                </div>
                            </th>
                            <th>
                                <div class="th">
                                    Проверенный
                                </div>
                            </th>
                        </tr>
                        </thead>
                        <tbody offer-group data-ng-repeat="tender in tender.info.offers">
                        <tr ng-click="open()" class="constell-open-row" ng-class="{'active' : opened}">
                            <td class="constell-open-icon">
                                <i ng-if="!opened" class="zmdi zmdi-caret-right"></i>
                                <i ng-if="opened" class="zmdi zmdi-caret-down"></i>
                            </td>
                            <td>{{tender.userId}}</td>
                            <td>{{tender.userName}}</td>
                            <td>{{tender.price}}</td>
                            <td>{{tender.dateStr}}</td>
                            <td>{{tender.comments}}</td>
                            <td>
                                <md-checkbox ng-model="tender.isCertified" data-ng-disabled="true"> {{ checkbox.cb1 }}
                                </md-checkbox>
                            </td>
                        </tr>
                        <tr ng-if="opened" class="constell-group-row">
                            <td colspan="7" class="constell-group-row-inner">
                                <table class="table table-bordered table-striped table-responsive">
                                    <thead>
                                    <tr>
                                        <th>
                                            <div class="th">
                                                ID
                                            </div>
                                        </th>
                                        <th>
                                            <div class="th">
                                                Позиция
                                            </div>
                                        </th>
                                        <th>
                                            <div class="th">
                                                Цена (руб)
                                            </div>
                                        </th>
                                        <th>
                                            <div class="th">
                                                Объем
                                            </div>
                                        </th>
                                        <th>
                                            <div class="th">
                                                Дата
                                            </div>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="children in tender.childrens">
                                        <td>{{children.id}}</td>
                                        <td>{{children.positionTitle}}</td>
                                        <td>{{children.price}}</td>
                                        <td>{{children.amount}} {{children.unit}}</td>
                                        <td>{{children.dateStr}}</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <footer class="table-footer">
                    <div class="row">
                        <div class="col-md-6 page-num-info">
                <span>
                Show
                <select data-ng-model="numPerPage"
                        data-ng-options="num for num in numPerPageOpt"
                        data-ng-change="onNumPerPageChange()">
                </select>
                entries per page
                </span>
                        </div>
                        <div class="col-md-6 text-right pagination-container">
                            <uib-pagination class="pagination-sm"
                                            ng-model="currentPage"
                                            total-items="tenders.list.TotalItemsCount"
                                            max-size="4"
                                            ng-change="select(currentPage)"
                                            items-per-page="10"
                                            rotate="false"
                                            previous-text="Назад" next-text="Далее"
                                            boundary-links="false"></uib-pagination>
                        </div>
                    </div>
                </footer>
            </section>
        </div>
    </div>

</div>
